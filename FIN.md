안녕하세요 여러분! 오늘은 저희 Safe Eye 프로젝트에 대해 소개하고자 합니다. Safe Eye는 CCTV나 보안 카메라에서 수집되는 방대한 비디오 데이터를 효과적으로 활용하여 편의점이나 무인 상점 등의 안전을 높이고자 하는 프로젝트입니다.

**프로젝트 목적과 주요 기능입니다.**
Safe Eye 프로젝트는 심투리얼이라는 기업과 연계하여 진행되었습니다. 심투리얼에서 제공받은 정제된 데이터와 고도화된 기술 조언 덕분에 우리는 더욱 정교한 시스템을 구축할 수 있었습니다.

사용자와 관련된 핵심 기능들로는 실시간 이상 행동 감지, 상세 분석 화면, 경고 및 알람 설정, 통계 및 보고 기능 등이 있습니다. PySlowFast 모델을 활용하여 폭력, 절도, 기물 파손 등의 이상 행동을 감지하고, 이를 웹 애플리케이션을 통해 실시간으로 모니터링할 수 있습니다.

**저희 서비스 플로우를 간단히 정리하면 다음과 같습니다.**

Django REST API를 통한 분석 결과 제공합니다. 해당 DRF를 통해 비디오 분석 결과를 클라이언트 애플리케이션에 제공합니다.

더불어 API 엔드포인트를 호출하여 이상 행동 감지 결과를 실시간으로 가져올 수 있습니다.

특히 API를 통해 비디오 분석 결과를 클라이언트 애플리케이션에 이상 행동 감지 결과를 실시간으로 제공합니다.

**기술 스택입니다.**

협업 도구로는 Git, GitHub, Discord, Notion 등을 활용했습니다.

프론트엔드는 JS, HTML/CSS, typescript 등을 활용했습니다.

백엔드는 python, Django, REST Framework 등을 활용했습니다.

배포는 AmazonAWS, AMAZONE3, NGINX 등을 활용했습니다.

데이터 처리 및 분석을 위해 numpy, pandas, scipy 등을 활용했습니다.

컴퓨터 비전 및 이미지 처리를 위해서는 Pytorch, CUDA, conda 등을 활용했습니다.

**시스템 아키텍처입니다.**

해당 아키텍처의 다이어그램 이미지는 본 사진 자료를 참고해주시면 됩니다. 이를 구체적으로 설명하면 다음과 같습니다.

**7개 단계들 순차적으로 잘 설명하기**

**라이센스입니다.**

저희 프로젝트는 오픈소스 소프트웨어를 활용하여 개발되었으며, pyslowfast, django, DRF 등을 사용했습니다. 사용된 주요 라이브러리 및 프레임워크의 라이센스 정보는 해당 페이지에 정리된 것들을 참고해주세요.

더불어 저희는 오픈소스 프로젝트이기에, 기능 제안, 코드 기여 등의 활동들을 언제나 환영합니다. 기여를 원하시면 'CONTRIBUTING.md' 파일을 참고해주세요.

**팀 소개입니다.**

저희 safe-eye 팀은 이혜림 팀장님을 필두로 5명의 동료들로 이루어져 있습니다. 모두가 해당 프로젝트에 기여할 수 있도록 과업 분배를 하였고, 그 결과 고르게 해당 프로젝트에 기여하게 되었습니다.

**시스템 주요 기능입니다.**
저희 팀은 CCTV 영상을 실시간으로 분석하여 폭력, 절도 등의 이상 행동을 감지하고 즉각적인 알람을 발송합니다. 사용자는 상세한 분석 화면을 통해 이벤트 정보를 확인하고, 경고 및 알람 설정을 편리하게 조정할 수 있습니다. 또한 시스템은 정기적인 테스트와 훈련을 예약하고 통계 및 보고서를 생성하여 사용자에게 제공합니다.

저희 와이어프레임은 다음과 같이 피그마로 정리했으며, 링크를 달았으니 원하신다면 나중에 참고하시면 됩니다. 다만 저희 측 페이지별 기능들을 세부 설명을 위해 잠시 들어가보겠습니다.

(피그마 기반으로 페이지별 기능 설명)
(이렇게 와이어프레임 및 기능 명세서, 화면 설계 등을 제대로 하면서 프론트 구현에도 최대한 도움이 되었다는 점 강조)

더불어 저희 서비스에 대한 ERD를 소개하겠습니다.

저희 서비스는 사용자 관련 테이블, 토큰 관련 테이블, 채팅 관련 테이블, 알림 관련 테이블, 그리고 유틸 관련 테이블로 구성되어 있습니다.

먼저, 사용자 관련 테이블에서는 accounts_customuser 테이블을 통해 사용자 정보를 저장합니다. 권한 관리를 위해 accounts_customuser_user_permissions와 accounts_customuser_groups 테이블이 있습니다.

다음은 토큰 관련 테이블입니다. accounts_usertoken 테이블은 사용자의 토큰 정보를 저장하며, 토큰의 블랙리스트 여부를 관리합니다.

채팅 관련 테이블에서는 chat_chatroom 테이블로 채팅방 정보를 저장하고, chat_message 테이블로 채팅 메시지 정보를 관리합니다.

알림 관련 테이블에서는 alarm_alarm 테이블로 알림 정보를 저장하고, alarm_alarmsettings 테이블로 사용자별 알림 설정을 관리합니다. 또한 알림 유형 정보를 담고 있는 alarm_alarmtype 테이블이 있습니다.

마지막으로 유틸 관련 테이블에서는 utils_status 테이블로 다양한 상태값을, utils_tag 테이블로 태그 정보를 저장합니다.

저희는 권한 부여하고 유저 정보를 관리하는 accounts 앱을 필두로, alarm-chat-media 등 4가지의 큰 기능들을 수행하는 앱들로 이루어져 있습니다. 구체적인 설명은 API 명세서에서 하겠습니다.

(동영상 참고하면서)
특히 저희 팀은 심투리얼과의 연계를 하면서 본 서비스 구현을 위한 모델링 및 시각화 과정까지는 다했습니다.

다만 리소스 부족으로 배포를 하지는 못했습니다.

**API 명세서입니다.**

우선 accounts 앱입니다. 여기서는 사용자 인증과 관련된 API들이 있습니다. 로그인, 로그아웃, 관리자 계정 생성 등의 기능을 제공하고 있습니다. 더불어 사용자 정보 조회, 수정, 삭제도 가능합니다. 권한에 따라 접근할 수 있는 API가 다르니 해당 파트를 잘 확인해주시면 됩니다.

다음은 alarm 앱입니다 여기는 알람과 위험 관련 API들이 있습니다. 알람과 위험을 생성하고 조회, 수정, 삭제할 수 있습니다. 알람 유형도 관리할 수도 있습니다. 다만 특이한 점으로는 'receive-alarm-data'라는 API이며, 해당 API는 알람 데이터를 수신하는 역할을 합니다.

chat 앱입니다. 채팅방과 메시지를 다루는 API들이 있으며. 채팅방을 생성하고 조회, 수정, 삭제하고, 각 채팅방 내에서 메시지도 마찬가지로 생성, 조회, 수정, 삭제가 가능합니다.

media 앱입니다. 여기서는 미디어 파일 관련 API를 제공합니다. 파일을 업로드하고 조회, 수정, 삭제할 수 있으며 'predict' API를 통해 미디어 파일을 예측할 수도 있습니다.

notice 앱입니다. 샘플로 만들었으며, 결과물과 최대한 비슷하게 나오게끔 하였습니다. 더불어 여기는 공지사항을 관리하는 API들이 있습니다. 공지사항 목록을 조회하고, 새로운 공지사항을 생성하고, 조회, 수정, 삭제를 할 수 있습니다. 이 앱의 API는 주로 관리자 권한이 필요하니 이 점을 유의해 주시면 되오며, 샘플로서 기능을 하니 참고 부탁드립니다.

다음과 같이 우리 프로젝트의 API 명세서를 간단하게 훑어봤습니다. 더 자세한 내용은 Swagger를 통해 확인하실 수 있습니다.

**진행 상황입니다.**

먼저, 프로젝트 아키텍처 설계와 기획을 마쳤습니다. 각 구성 요소 간의 상호 작용과 데이터 흐름을 고려하여 시스템 구조를 설계했습니다.

그리고 백엔드 앱 구조를 설계하고 개발했습니다. Django 프레임워크를 사용하여 accounts, utils, media, alarm, notice 등의 앱을 개발했습니다.

프론트엔드에서는 개발 환경을 구축하고 초기 화면을 개발하기 시작했습니다. 또한 Next.js를 활용하여 UI를 개발하고 있습니다.

이 모든 작업을 GitHub의 이슈 템플릿, 위키, 프로젝트 기능을 활용하여 효율적으로 관리하고 있습니다. 또한, 실시간 소통과 협업은 디스코드를 통해 이루어지고 있습니다.

그리고 우리는 일관된 코드 스타일과 표준을 준수하고 있습니다. 코드 스타일은 PEP 8을 기반으로 하며, Black 포매터를 사용하여 자동으로 통일시키고 있습니다. 커밋 메시지 컨벤션을 따라 각각의 커밋은 명확하고 간결한 제목을 갖고 있습니다.

특히 저희는 위키 제작에 힘을 많이 쏟았습니다. 저희를 피드백해준 강사님이 참고를 하라고 말씀하실 정도로 그 결과 협업을 하는데 있어서 매우 용이하게 서로의 코드 환경을 조성했습니다. 그 결과 협업해서 팀 동료들과 코드를 짜고 공유하는데 있어서 문제 없이 진행할 수 있게 되었습니다.

(우리 팀 위키 레퍼런스들 전체적으로 보여주기)

**트러블 슈팅입니다.**

해당 파트에서 여러 글들이 있지만, 그 중 저희가 가장 중요시 생각했던 부분들을 중점적으로 발표하겠습니다.

**첫번째, 로컬 환경에서의 데이터베이스 설정 이슈(PostgreSQL)입니다.**

팀원들이 각자 로컬 환경에서 PostgreSQL을 사용하면서 데이터베이스 관련 이슈가 다수 발생했습니다. 특히 앱의 필수 조건이 아닌 데이터가 마이그레이션 과정에서 삽입되면서 데이터베이스가 손상되는 문제가 심각했습니다. 이는 팀원들 간 코드 공유 과정에서 전파되어 프로젝트 진행에 큰 차질을 빚었습니다.

문제 해결을 위해 우리는 로컬 환경에서 마이그레이션을 실행하지 않고 Django의 기본 데이터베이스 설정을 사용하기로 결정했습니다. 이를 통해 불필요한 데이터 삽입을 방지하고 데이터베이스 손상 문제를 해결할 수 있었습니다.

이 경험을 통해 우리는 로컬과 프로덕션 환경의 데이터베이스 설정이 다를 수 있음을 인지하고, 상황에 맞는 적절한 설정의 중요성을 깨달았습니다. 또한 마이그레이션 과정에서의 데이터 삽입에 주의를 기울이고, 팀 내 데이터베이스 설정에 대한 규칙 정립의 필요성도 절감하였습니다.

**두번째, 이미지 업로드 및 표시 이슈입니다.**
사용자가 업로드한 이미지를 서버에 저장하고 웹 페이지에 표시하는 과정에서 다양한 이슈가 발생했습니다. 이를 해결하기 위해 이미지 업로드 시 파일 형식, 크기, 해상도 등을 검증하는 로직을 구현하고, 썸네일 생성 기능을 추가하였습니다. 또한 웹 페이지 로딩 속도 개선을 위해 이미지 사이즈 조정 등의 최적화 작업도 진행하였습니다.

**세번째, PySlowFast 모델 API 연동 이슈입니다.**
PySlowFast 모델 API와 Django 앱 간 통신 과정에서 여러 이슈가 발생했습니다. 이를 해결하기 위해 PySlowFast 모델 API 엔드포인트 URL을 환경 변수로 설정하여 유연성을 높였고, views.py에서 API 요청 및 응답 처리 로직을 구현하였습니다. 또한 응답 데이터 파싱 및 처리 로직을 작성하고, 로깅을 통해 디버깅을 수행하였습니다.

**저희 팀 회고입니다.**

본 프로젝트를 시작할 때에는 많은 도전이 있었습니다. 하지만 팀원들과 함께 노력하고 협력하여 이를 극복할 수 있었습니다. 백엔드 앱 구조부터 프론트엔드 개발 환경까지 다양한 작업을 수행하며 성장할 수 있었습니다.

이번 프로젝트를 통해 우리는 기술적인 지식 뿐만 아니라 협업과 소통의 중요성을 깨달을 수 있었습니다. 특히 팀원들과 함께 문제를 해결하는 과정에서 많은 것을 배웠습니다.

마지막으로, 함께 고생한 팀원들과 멘토님들, 지원해주신 분들께 진심으로 감사의 말씀을 전합니다. 특히 저같은 경우에는 처음 프로젝트를 시행할 때만 해도 실력이 많이 부족해서 팀에 남아있는게 민폐일 거라고 생각하며 많이 힘들었던 적이 있습니다. 그러나 혜림 팀장님을 필두로 저희 지용-규성-경민 동료 분들과 함께 서로 과업 분배를 잘하면서 진행을 서로 도우면서 결국에는 잘 끝맺었습니다. 자조감에 젖었던 제가 이렇게 자원해서 발표를 하게 된 것만 봐도 정말 많은 성장과 진화가 있었다고 생각하며 이렇게 좋은 기회 주신 Proactive 팀과 위니브, 모두의 연구소 유관자 분들께 모두 감사드립니다.
