안녕하세요 여러분! 오늘 이 자리에서 저희 Safe Eye 프로젝트에 대해 소개하고자 합니다. Safe Eye 프로젝트는 CCTV나 보안 카메라에서 수집되는 방대한 양의 비디오 데이터를 효과적으로 활용하여 우리 사회를 좀 더 안전하게 만들고자 하는 목적에서 시작되었습니다.

🎯 프로젝트 목적과 주요 기능
우리 주변에는 수많은 CCTV와 보안 카메라가 설치되어 있지만, 이렇게 수집되는 엄청난 양의 비디오 데이터가 범죄 예방이나 신속한 사건 대응에 충분히 활용되지 못하고 있는 실정입니다. Safe Eye는 이런 문제를 해결하기 위해 탄생했습니다.

Safe Eye는 크게 세 가지 부분으로 구성되어 있습니다.

비디오 업로드 및 관리 부분
AI 모델을 통한 비디오 분석 부분
분석 결과를 확인하고 알람을 받을 수 있는 웹 애플리케이션 부분
사용자는 웹 애플리케이션을 통해 비디오를 업로드하면, 이 비디오는 안전하게 Amazon S3 클라우드 스토리지에 저장됩니다. 그리고 Django 백엔드 애플리케이션이 이 비디오의 URL을 Facebook AI Research에서 개발한 강력한 비디오 분석 모델인 PySlowFast에 전달합니다.

PySlowFast 모델은 비디오 프레임을 분석하여 폭력, 절도, 방화 등의 이상 행동 패턴을 감지하고 분류합니다. 이렇게 감지된 이상 행동에 대한 정보, 예를 들면 해당 행동이 발생한 비디오의 시간대, 관련 이미지 등을 Django 애플리케이션에 다시 전달하죠.

사용자는 웹이나 모바일 앱을 통해 이 Django 애플리케이션에 접속하여 Django REST API를 통해 AI 모델의 분석 결과를 실시간으로 확인할 수 있습니다. 만약 위험한 상황이 감지되면, 즉시 알람을 받고 해당 상황의 비디오 클립이나 스크린샷 등을 확인할 수 있습니다.

🛠️ 기술 스택
Safe Eye 프로젝트에는 다양한 기술들이 사용되었습니다.

백엔드는 Python의 Django 프레임워크를 사용하였습니다.
프론트엔드는 React를 사용하였고요.
데이터베이스로는 PostgreSQL을 선택하였습니다.
개발 과정에서는 Git과 GitHub을 통해 버전 관리와 협업을 진행하였고, Discord를 통해 실시간 소통을 하였습니다.
또한 코드의 일관성과 가독성을 유지하기 위해 PEP 8 기반의 파이썬 코드 스타일 가이드를 준수하였고, Black 포매터를 사용하여 코드 스타일을 자동으로 통일하였습니다. Git 커밋 메시지도 컨벤션을 따르도록 하여 변경사항을 쉽게 파악할 수 있도록 하였습니다.

🚧 트러블 슈팅
Safe Eye 프로젝트를 진행하면서 우리는 많은 어려움에 직면했습니다. 하지만 이 과정에서 더 많이 배우고 성장할 수 있었습니다.

🌐 스토리지 설정 이슈
Django 개발 서버에서 정적 파일과 미디어 파일을 제대로 서빙하지 못하는 문제가 발생했습니다. 이를 해결하기 위해 프로덕션 환경에서는 Amazon S3를 사용하고, 로컬 환경에서는 파일 시스템을 사용하도록 설정을 변경하였습니다. 이를 통해 우리는 프로젝트 설정 단계에서 파일 저장 및 관리 전략을 세우는 것이 얼마나 중요한지 깨달을 수 있었습니다.

🖼️ 이미지 업로드 및 표시 이슈
사용자가 업로드한 이미지를 서버에 저장하고 웹 페이지에 표시하는 과정에서도 여러 문제가 발생했습니다. 이를 해결하기 위해 이미지 업로드 시 파일 형식, 크기, 해상도 등을 검증하는 로직을 구현하고, 썸네일 생성 기능을 추가하였습니다. 또한 웹 페이지에 이미지를 표시할 때 적절한 크기로 조정하고 로딩 속도를 개선하는 작업도 진행하였습니다. 이 과정을 통해 이미지 처리가 복잡한 작업이며, 보안, 성능, 사용자 경험 등 다양한 측면을 고려해야 한다는 것을 배웠습니다.

🔒 정적 파일과 앱 이름 충돌 문제
'media' 앱 이름과 'static' 디렉토리 이름이 겹치면서 충돌 문제가 발생했습니다. 이를 해결하기 위해 settings.py 파일에서 정적 파일을 S3에 연결하는 설정을 제거하고, 프로덕션 환경에서 정적 파일은 웹 서버를 통해 직접 제공하도록 변경하였습니다. 또한 기존 'media' 앱의 이름을 'videos'로 변경하고 관련 코드를 모두 수정하였습니다. 이 과정을 통해 프로젝트 구조와 명명 규칙을 잘 지키는 것이 얼마나 중요한지 깨달았습니다.

🌉 PySlowFast 모델 API 연동 이슈
PySlowFast 모델 API와 Django 앱 간의 통신 과정에서도 여러 이슈가 있었습니다. 이를 해결하기 위해 PySlowFast 모델 API 엔드포인트 URL을 환경 변수로 설정하여 유연성을 높였고, views.py에서 API 요청 및 응답 처리 로직을 구현하였습니다. 또한 API 응답 형식에 맞춰 결과 데이터를 파싱하고 처리하는 로직을 작성하였고, Django 로그 파일에 API 요청 및 응답 데이터를 기록하여 디버깅을 수행하였습니다.

🪣 AWS S3 버킷 설정 문제
S3 버킷의 CORS 설정이 올바르게 되어 있지 않아 Django 앱에서 S3에 호스팅된 미디어 파일에 접근할 수 없는 문제가 발생했습니다. 이를 해결하기 위해 S3 버킷의 CORS 설정을 확인하고 수정하여, 웹 애플리케이션에서 S3에 호스팅된 미디어 파일에 접근할 수 있도록 허용하였습니다. 또한 AWS 인증 정보와 같은 민감한 정보는 환경 변수 파일에 저장하고, 이 파일을 공개 저장소에 업로드하지 않도록 주의하였습니다.

📹 비디오 파일 처리 방식 변경
기존에는 비디오 파일을 로컬에 저장했지만, 이제는 S3 버킷에 업로드된 비디오 파일의 URL만 저장하도록 변경되었습니다. 이를 위해 MediaFile 모델에서 'file' 필드 대신 'video_url' 필드를 URLField로 정의하였고, views.py의 predict 메소드에서 media_file.video.url을 사용하여 S3에 저장된 비디오 파일의 URL을 PySlowFast 모델 API에 전달하도록 수정하였습니다. 또한 프론트엔드 코드에서 비디오 파일 업로드 대신 S3 URL 입력 폼을 구현하였습니다.

🎥 PySlowFast 모델 API 응답 처리
PySlowFast 모델 API의 응답 형식이 { "output_video": "/path/to/output.mp4", "abnormal_images": ["/path/to/image1.jpg", "/path/to/image2.jpg"], "coordinates": [[100, 200], [150, 250]] } 와 같은 형태로 제공되었습니다. 이를 처리하기 위해 views.py의 predict 메소드에서 API 응답 데이터에서 'output_video', 'abnormal_images', 'coordinates' 키에 해당하는 값을 추출하는 로직을 구현하고, 추출한 값들을 딕셔너리 형태로 media_file.result에 저장하였습니다.

🗄️ 로컬 환경에서의 데이터베이스 설정 이슈(PostgreSQL)
팀원들이 각자의 로컬 환경에서 PostgreSQL 데이터베이스를 사용하면서 데이터베이스 관련 이슈가 발생했습니다. 앱의 필수 조건이 아닌 데이터가 마이그레이션 과정에서 데이터베이스에 삽입되면서 데이터베이스가 손상되는 문제가 발생했고, 이러한 문제가 팀원들 간에 코드를 공유하는 과정에서 전파되어 다른 팀원들의 로컬 환경에서도 동일한 이슈가 발생했습니다.

이를 해결하기 위해 로컬 환경에서는 마이그레이션을 실행하지 않고 Django의 기본 데이터베이스 설정을 사용하기로 결정하였습니다. 이를 통해 불필요한 데이터 삽입으로 인한 데이터베이스 손상을 방지할 수 있었고, 로컬 환경에서의 데이터베이스 관련 이슈를 최소화할 수 있었습니다.

이 과정을 통해 우리는 로컬 환경에서의 데이터베이스 설정이 프로덕션 환경과 다를 수 있으며, 상황에 맞는 적절한 설정이 필요하다는 것을 배웠습니다. 또한 불필요한 데이터 마이그레이션이 데이터베이스 손상을 야기할 수 있으므로 주의해야 하며, 팀 내에서 데이터베이스 설정에 대한 일관된 규칙을 정립하고 공유하는 것이 얼마나 중요한지 깨달았습니다.

🔮 Safe Eye의 미래
Safe Eye 프로젝트는 아직 완성된 것이 아닙니다. 우리에게는 아직 가야 할 길이 멀게 느껴집니다. 더 많은 기능을 추가하고, 더 정확한 분석을 할 수 있도록 AI 모델을 계속 발전시켜 나가야 합니다. 또한 실제 도입을 위해서는 개인정보 보호 등의 법적, 윤리적 문제도 심도 있게 논의해야 할 것입니다.

하지만 우리는 이 길이 분명 가야 할 길이라고 믿습니다. 기술의 발전이 우리의 삶을 더 안전하고 편리하게 만들 수 있다는 것, 그리고 그 중심에는 언제나 사람이 있어야 한다는 것. 이것이 저희 Safe Eye 팀이 가진 신념입니다.

앞으로도 Safe Eye는 계속해서 발전해 나갈 것입니다. 우리의 노력이 언젠가 실제 현장에서 빛을 발할 수 있기를, 그리고 더 안전한 사회를 만드는 데 기여할 수 있기를 희망합니다.

여러분의 많은 관심과 응원 부탁드립니다. 긴 시간 경청해 주셔서 감사합니다!
